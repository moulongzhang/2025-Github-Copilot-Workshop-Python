# ポモドーロタイマー 段階的実装計画

## フェーズ1：基本的なタイマー機能（MVP）
目標：基本的なタイマー機能とUIの実装

### 1.1 プロジェクト設定（1日目）
- [x] プロジェクト構造の作成
- [x] 必要なパッケージのインストール（Flask, pytest）
- [x] 基本的な設定ファイルの作成

### 1.2 バックエンドの基礎実装（2日目）
 - [x] `Timer`モデルの実装
  - 基本的な状態管理
  - 時間計算ロジック
 - [x] `TimerService`の基本実装
  - 開始/リセット機能
  - 状態変更処理
 - [x] 基本的なルーティングの実装

### 1.3 フロントエンドの基礎実装（3日目）
- [x] 基本的なHTMLテンプレートの作成
- [x] シンプルなタイマー表示のCSS
- [x] 基本的なタイマー制御のJavaScript
  - カウントダウン機能
  - 開始/リセットボタンの制御

### 完了条件
- タイマーの開始とリセットが可能
- 25分のカウントダウンが正確に動作
- 基本的なUIが表示される

## フェーズ2：視覚的フィードバックの強化（MVP+）
目標：UIの改善とプログレス表示の実装

### 2.1 プログレス表示の実装（4日目）
- [ ] サークル型プログレスバーのHTML/CSS実装
- [ ] プログレスバーのアニメーション処理
- [ ] 残り時間の表示形式の整備

### 2.2 状態表示の改善（5日目）
- [ ] 現在の状態（作業中/休憩中）の表示
- [ ] ボタンのスタイリング改善
- [ ] レスポンシブデザインの適用

### 完了条件
- プログレスバーが正しく動作
- 視覚的に分かりやすい状態表示
- モバイル対応のレイアウト

## フェーズ3：進捗管理機能（コア機能完成）
目標：セッション管理と進捗表示の実装

### 3.1 セッション管理の実装（6日目）
- [ ] ポモドーロカウントの実装
- [ ] 累計時間の計算機能
- [ ] セッションデータの永続化

### 3.2 進捗表示UIの実装（7日目）
- [ ] 今日の進捗セクションの作成
- [ ] 完了数と累計時間の表示
- [ ] LocalStorageを使用したデータ保存

### 完了条件
- セッション数のカウントが正確
- 累計時間が正しく計算される
- ブラウザリロード後もデータが保持される

## フェーズ4：通知システム（UX向上）
目標：通知機能の実装

### 4.1 ブラウザ通知の実装（8日目）
- [ ] `NotificationService`の実装
- [ ] 通知許可の取得処理
- [ ] タイマー完了時の通知送信

### 4.2 視覚・音声フィードバックの実装（9日目）
- [ ] タイマー完了時のUI変更
- [ ] 通知音の実装
- [ ] タブタイトルでの状態表示

### 完了条件
- デスクトップ通知が正しく動作
- 適切な音声フィードバック
- タブを切り替えても状態が分かる

## フェーズ5：エラーハンドリングと最適化（完成度向上）
目標：信頼性とパフォーマンスの向上

### 5.1 エラーハンドリングの実装（10日目）
- [ ] 例外処理の実装
- [ ] エラーメッセージの表示
- [ ] リカバリー機能の実装

### 5.2 パフォーマンス最適化（11日目）
- [ ] アニメーションの最適化
- [ ] メモリ使用量の最適化
- [ ] エラーログの実装

### 完了条件
- エラー時の適切なフィードバック
- スムーズなアニメーション
- 安定した動作

## 追加フェーズ（オプション）
必要に応じて実装する追加機能

### カスタマイズ機能
- [ ] タイマー時間の設定
- [ ] テーマカラーの変更
- [ ] 通知設定のカスタマイズ

### 統計機能
- [ ] 詳細な作業統計
- [ ] データの可視化
- [ ] エクスポート機能

## 注意点
1. 各フェーズでテストを並行して実装
2. 各機能実装後にコードレビューを実施
3. ユーザーフィードバックを収集し、必要に応じて調整
4. セキュリティ対策は各フェーズで考慮

## ここまでの進捗（2025-10-24）

### 実施済み（フェーズ1 の一部と準備）
- `other/` ディレクトリを作成し、プロジェクトに関係のないファイルを移動しました: `deliverManager.py`, `main.py`, `point.py`, `point2.py`
- プロジェクト構造を作成しました:
  - `pomodoro/` サブパッケージ (`models/`, `services/`, `web/`)
  - `static/` (`css/`, `js/`) と `templates/` を追加
- 基本設定ファイルを追加しました: `config.py` (タイマー設定を含む)

### 追加した実装ファイル（フェーズ1.2 / フェーズ1.3準備）
- `pomodoro/models/timer.py` — `Timer` モデル（start/pause/reset/get_state）
- `pomodoro/services/timer_service.py` — `TimerService`（モデルのラッパー、start/pause/reset/get_state）
- `pomodoro/web/routes.py` — 基本ルートと API エンドポイント
- `templates/index.html`, `static/js/timer.js`, `static/css/style.css` — 最小限のフロントエンド（API呼び出しとUI）
- `app.py` をアプリファクトリ化して Blueprint を登録するように変更しました

### テストと検証
- 単体テストを追加しました:
  - `tests/unit/test_timer_model.py`
  - `tests/unit/test_timer_service.py`
- 依存パッケージをインストールしました（`requirements.txt` を追加）
- pytest を実行してテストを検証しました: `4 passed`（全テスト合格）

### 現状の挙動確認方法（ローカル）
1. 依存パッケージをインストール:
```powershell
C:/Users/ueda/AppData/Local/Microsoft/WindowsApps/python3.13.exe -m pip install -r requirements.txt
```
2. 開発サーバー起動:
```powershell
C:/Users/ueda/AppData/Local/Microsoft/WindowsApps/python3.13.exe app.py
```
3. テスト実行:
```powershell
C:/Users/ueda/AppData/Local/Microsoft/WindowsApps/python3.13.exe -m pytest -q
```

---

今後の推奨タスク:
- `tests/integration/test_routes.py` による API 統合テストの追加
- LocalStorage を使ったフロントエンド側の永続化（フェーズ3）
- UI をモックに近づけるスタイリングとプログレスサークルの実装（フェーズ2）
- CI（GitHub Actions）でテスト実行を自動化するワークフローの追加
