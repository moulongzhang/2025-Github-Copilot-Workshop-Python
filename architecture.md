# ポモドーロタイマーWebアプリ アーキテクチャ案

## 1. 技術スタック
- バックエンド: Flask (Python)
- フロントエンド: HTML, CSS, JavaScript
- テンプレートエンジン: Jinja2 (Flask標準)
- 静的ファイル: `static/` ディレクトリに配置

## 2. ディレクトリ構成例
```
/project-root/
├── app.py                # Flaskアプリ本体
├── templates/
│   └── index.html        # メインUI（Jinja2テンプレート）
├── static/
│   ├── css/
│   │   └── style.css     # スタイルシート
│   └── js/
│       └── timer.js      # タイマーのロジック
├── tests/                # ユニットテスト
│   ├── test_app.py
│   └── ...
├── requirements.txt      # 依存パッケージ
└── architecture.md       # アーキテクチャドキュメント
```

## 3. アプリケーション構成
### バックエンド（Flask）
- `/` ルートでメイン画面を表示。
- 必要に応じてAPIエンドポイント（例: `/api/save`, `/api/history`）を用意。
- タイマー自体はクライアント側で動作させ、サーバーは主にデータ保存や履歴取得などを担当。
- アプリ本体とロジック（履歴管理など）は分離し、テストしやすい構成にする。
- 設定やDBは依存注入可能な設計とし、テスト用DBも利用可能にする。

### フロントエンド（HTML/CSS/JavaScript）
- UIは`index.html`で作成し、Jinja2で動的要素を埋め込む。
- タイマーのカウントダウンや状態管理は`timer.js`で実装。
- スタイルは`style.css`で管理。
- タイマーや状態遷移のロジックはクラスや関数として分離し、テストしやすくする。
- 必要に応じてAjax（fetch API）でFlaskのAPIと通信。

## 4. ユニットテスト容易性への配慮
- Flaskアプリ本体とロジックを分離し、ロジック部分は関数やクラスとしてテスト可能にする。
- テンプレートはロジックを持たず、表示専用に徹する。
- テスト用設定・テスト用DBを導入し、テストの独立性を保つ。
- JavaScriptのロジックもモジュール化し、JestやMocha等でテスト可能にする。
- CI/CDでpytestやunittest、Jest等による自動テストを実行。

## 5. API設計例（必要な場合）
- `GET /` … メイン画面表示
- `POST /api/save` … セッション履歴保存
- `GET /api/history` … 履歴取得

## 6. 実装・開発フロー
1. 静的なUIをHTML/CSSで作成
2. JavaScriptでタイマー機能を実装
3. Flaskでサーバーサイドを組み合わせ
4. テストコードを作成し、CI/CDで自動化

## 7. その他の設計方針
- レスポンシブデザイン対応（必要に応じて）
- 将来的な拡張（ユーザー管理や履歴分析など）を見据えたAPI設計
- セキュリティや例外処理も考慮

---
このアーキテクチャをベースに、実装・テスト・運用を進めていきます。