# ポモドーロタイマーWebアプリ アーキテクチャ案

## 1. 概要

本アプリはFlask（Python）をバックエンド、HTML/CSS/JavaScriptをフロントエンドとしたWebベースのポモドーロタイマーです。添付UIモックのようなシンプルかつモダンなUIを目指します。

---

## 2. 全体構成

- **バックエンド（Flask）**
  - タイマー進捗や履歴データの管理
  - APIエンドポイントの提供（進捗取得・記録など）
  - HTMLテンプレートの配信
- **フロントエンド（HTML/CSS/JavaScript）**
  - タイマーUI・進捗表示
  - タイマーのカウントダウン・開始/リセット操作
  - APIとの通信（fetch/AJAX）

---

## 3. ディレクトリ構成例

```
/project-root
  /static
    /css
      style.css
    /js
      timer.js
  /templates
    index.html
  app.py
  models.py
  requirements.txt
  architecture.md
  /tests
    test_progress_service.py
    test_api.py
```

---

## 4. バックエンド設計

- **ルーティング例**
  - `/` : メイン画面（index.html）
  - `/api/progress` : 今日の進捗データ取得（GET）、進捗記録（POST）
- **ロジック分離**
  - タイマーや進捗計算などのビジネスロジックは`services`や`utils`モジュールに分離
  - データ保存層（DBやファイル）はラッパークラス経由でアクセスし、依存性注入可能に
- **テスト性**
  - Flask BlueprintでAPIを分割
  - テスト用DBやモックを使える設計
  - 設定値はconfigファイルや環境変数で管理

---

## 5. フロントエンド設計

- **HTML/CSS**
  - UIモックに沿った構造・デザイン
- **JavaScript**
  - タイマーのカウントダウン・進捗の更新
  - 「開始」「リセット」ボタンの制御
  - API通信部分はラップし、テストやモック化しやすく
  - ロジックは関数化し、UI操作と分離

---

## 6. ユニットテストのしやすさへの配慮

- バックエンドのロジック・データアクセス層を分離し、単体テスト可能に
- APIはFlaskのテストクライアントでリクエスト・レスポンスを検証
- フロントエンドのロジックも関数化し、Jest等でテスト可能に
- CI/CDで自動テスト実行を推奨

---

## 7. セキュリティ・ベストプラクティス

- APIの入力値バリデーション
- SQLインジェクション対策（パラメータ化クエリやORM利用）
- セッション管理やCSRF対策（必要に応じて）

---

## 8. 拡張性・保守性

- ロジック・UI・データ層の分離
- Blueprintやモジュール分割による機能追加のしやすさ
- 設定値や依存性の注入で環境ごとの切り替え容易

---

## 9. 補足

- 必要に応じてユーザー認証やDB設計も拡張可能
- テスト用ディレクトリ・ファイルを用意し、品質担保

---

以上の設計方針に基づき、開発・実装を進めていきます。
